<div class="top-container">

  <!-- Site Title Bar -->
  <mat-toolbar color="primary" class="site-title">
    <mat-toolbar-row>
      <span class="span">
        <a [routerLink]="['/']" class="hidden-link" >Duelist Metrics Server</a>
      </span>
    </mat-toolbar-row>
  </mat-toolbar>

  <mat-drawer-container class="all-page-content" autosize>
    <!-- Page Title -->
    <!-- <mat-toolbar color="#303030" class="page-title">
      <mat-toolbar-row>
        <span class="span">{{getTitle()}}</span>
      </mat-toolbar-row>
    </mat-toolbar>-->

    <!-- Sidebar -->
    <mat-drawer #drawer class="sidebar" mode="side" [opened]="isSidebarOpen()">
      <mat-label class="sidebar-nav-label">Navigation</mat-label>
      <mat-divider></mat-divider>
      <button mat-menu-item [matMenuTriggerFor]="runmenu">Runs</button>
      <mat-menu #runmenu="matMenu">
        <button mat-menu-item [matMenuTriggerFor]="charactersmenu">Characters</button>
        <mat-menu #charactersmenu="matMenu">
          <div *ngFor="let char of characters">
            <button mat-menu-item [routerLink]="char === 'THE_DUELIST' ? ['/runs', 'Duelist', 'Character'] : ['/runs', 'Character', char]">{{char}}</button>
          </div>
        </mat-menu>
        <button mat-menu-item [matMenuTriggerFor]="countrymenu">Locale</button>
        <mat-menu #countrymenu="matMenu">
          <div *ngFor="let country of countries">
            <button mat-menu-item [routerLink]="['/runs', 'Country', country.id]">{{country.name}}</button>
          </div>
        </mat-menu>
        <button mat-menu-item [matMenuTriggerFor]="timemenu">Timeframe</button>
        <mat-menu #timemenu="matMenu">
          <div *ngFor="let time of times">
            <button mat-menu-item [routerLink]="['/runs', 'Time', time]">{{time}}</button>
          </div>
        </mat-menu>
        <button mat-menu-item [routerLink]="['/runs', 'Duelist']">The Duelist</button>
        <button mat-menu-item [routerLink]="['/runs', 'Non-Duelist']">Non-Duelist</button>
        <button mat-menu-item [routerLink]="['/runs', 'All']">All</button>
      </mat-menu>
      <button mat-menu-item [matMenuTriggerFor]="deckmenu">Decks</button>
      <mat-menu #deckmenu="matMenu">
        <div *ngFor="let deck of decks">
          <button mat-menu-item [matMenuTriggerFor]="deckSubMenu">{{deck.name}}</button>
          <mat-menu #deckSubMenu="matMenu">
            <div *ngIf="deck.name === 'All'; else elseBlock">
              <button mat-menu-item [routerLink]="['/compare']">Compare</button>
              <button mat-menu-item [routerLink]="['/deckPopularity']">Popularity</button>
            </div>
            <ng-template #elseBlock>
              <!--<button mat-menu-item [routerLink]="['/info', deck.id]">Info</button>-->
            </ng-template>
            <button mat-menu-item [routerLink]="['/cards', deck.id]">Cards</button>
            <button mat-menu-item [routerLink]="['/relics', deck.id]">Relics</button>
            <button mat-menu-item [routerLink]="['/potions', deck.id]">Potions</button>
            <button mat-menu-item [routerLink]="['/neow', deck.id]">Neow</button>
          </mat-menu>
        </div>
      </mat-menu>
      <button mat-menu-item [matMenuTriggerFor]="infomenu">Info</button>
      <mat-menu #infomenu="matMenu">
        <!--<button mat-menu-item [matMenuTriggerFor]="infoSubStatsMenu">Stats</button>
        <mat-menu #infoSubStatsMenu="matMenu">
          <button mat-menu-item [routerLink]="['/info/stats', 'THE_DUELIST']">The Duelist</button>
          <div *ngFor="let char of characters">
            <div *ngIf="char !== 'THE_DUELIST'">
              <button mat-menu-item [routerLink]="['/info/stats', char]">{{char}}</button>
            </div>
          </div>
        </mat-menu>-->
        <button mat-menu-item [routerLink]="['/info/run-count-country']">Run Count by Country</button>
      </mat-menu>
      <button mat-menu-item [routerLink]="['/modList']">Mods</button>

      <mat-label class="sidebar-options-label">Options</mat-label>
      <mat-divider></mat-divider>
      <div *ngIf="getTitle() === 'Run Log'">
        <button mat-menu-item (click)="toggleFilterBox('hide')" id="hide-filters">Hide Filters</button>
        <button mat-menu-item (click)="toggleFilterBox('show')" style="display: none" id="show-filters">Show Filters</button>
      </div>
      <div *ngIf="getTitle() === 'Deck Popularity'">
        <button mat-menu-item [matMenuTriggerFor]="years">Year</button>
        <mat-menu #years="matMenu">
          <button mat-menu-item [routerLink]="['/deckPopularity', 2020]">2020</button>
          <button mat-menu-item [routerLink]="['/deckPopularity', 2019]">2019</button>
        </mat-menu>
      </div>


      <mat-label class="sidebar-links-label">Links</mat-label>
      <mat-divider></mat-divider>
      <button mat-menu-item [matMenuTriggerFor]="sourceMenu">Source Code</button>
      <mat-menu #sourceMenu="matMenu">
        <button mat-menu-item (click)="goToUrl('https://github.com/adambennett/StS-DuelistMod', true)">DuelistMod</button>
        <button mat-menu-item (click)="goToUrl('https://github.com/adambennett/StS-Metrics-Server', true)">Metrics API</button>
        <button mat-menu-item (click)="goToUrl('https://github.com/adambennett/StS-Metrics-Site', true)">Metrics Site</button>
      </mat-menu>
      <button mat-menu-item [matMenuTriggerFor]="extraFooterInfoMenu">Extras</button>
      <mat-menu #extraFooterInfoMenu="matMenu">
        <button mat-menu-item (click)="goToUrl('https://discord.gg/Tcwws6U', true)">Discord</button>
        <button mat-menu-item (click)="goToUrl('https://steamcommunity.com/sharedfiles/filedetails/?id=1673346215', true)">Steam Workshop</button>
      </mat-menu>
      <button mat-menu-item [matMenuTriggerFor]="donationMenu">Donate</button>
      <mat-menu #donationMenu="matMenu">
        <button mat-menu-item (click)="goToDonate()">Paypal</button>
      </mat-menu>

      <!--  Arrows to Collapse Sidenav Bar -->
<!--      <div style="margin-left: 10px">
        <img src="https://visitor-badge.glitch.me/badge?page_id=sts-metrics-site" alt="visitor badge"/>
      </div>-->
      <button mat-menu-item (click)="toggleSidebar(drawer)">
        <img src="assets/icons/arrows.svg" class="flipSvg" alt="sidebar toggle arrow icon (close)">
      </button>
    </mat-drawer>

    <!-- Open Sidebar -->
    <div class="example-sidenav-content">
      <div *ngIf="!isSidebarOpen()" id="sidebar-opener">
        <button type="button" mat-button (click)="toggleSidebar(drawer)">
          <img src="assets/icons/arrows.svg" alt="sidebar toggle arrow icon (open)">
        </button>
      </div>
    </div>

    <!-- Dynamic Page Content -->
    <main class="dynamic-page-content">
      <router-outlet></router-outlet>
    </main>
  </mat-drawer-container>
</div>
